package com.sgsi.emre.util;

/**
 * This class lays out the coordinate positions for 96 and 384 well plates
 * in either column major or row major.
 * @author bobbyjo
 * @date 05/27/2009
 */
public class PlateLayout 
{
	public static final int CM_96WELL = 0; //96 well column major
	public static final int RM_96WELL = 1; //96 well row major
	public static final int CM_384WELL = 2; //384 well column major
	public static final int RM_384WELL = 3; //384 well row major
	public static boolean bUseBiochemLayout = false;
	public static boolean bUseIsolateLayout = false;
	
	public static final String[] CM96_AlphaCoord = {
		"A01","B01","C01","D01","E01","F01","G01","H01",
		"A02","B02","C02","D02","E02","F02","G02","H02",
		"A03","B03","C03","D03","E03","F03","G03","H03",
		"A04","B04","C04","D04","E04","F04","G04","H04",
		"A05","B05","C05","D05","E05","F05","G05","H05",
		"A06","B06","C06","D06","E06","F06","G06","H06",
		"A07","B07","C07","D07","E07","F07","G07","H07",
		"A08","B08","C08","D08","E08","F08","G08","H08",
		"A09","B09","C09","D09","E09","F09","G09","H09",
		"A10","B10","C10","D10","E10","F10","G10","H10",
		"A11","B11","C11","D11","E11","F11","G11","H11",
		"A12","B12","C12","D12","E12","F12","G12","H12"
		};
	
	public static final String[] CM96_AlphaCoord_Isolates = {
		"A01","B01","C01","D01","E01","F01","G01","H01",
		"A02","B02","C02","D02","E02","F02","G02","H02",
		"A03","B03","C03","D03","E03","F03","G03","H03",
		"A04","B04","C04","D04","E04","F04","G04","H04",
		"A05","B05","C05","D05","E05","F05","G05","H05",
		"A06","B06","C06","D06","E06","F06","G06","H06",
		"A07","B07","C07","D07","E07","F07","G07","H07",
		"A08","B08","C08","D08","E08","F08","G08","H08",
		"A09","B09","C09","D09","E09","F09","G09","H09",
		"A10","B10","C10","D10","E10","F10","G10","H10",
		"A11","B11","C11","D11","E11","F11","G11","H11",
		"A12","B12","C12","D12","E12","F12"};
	
	public static final String[] CM96_AlphaCoord_Biochem = {
		"A01","B01","C01","D01","E01","F01","G01","H01",
		"A02","B02","C02","D02","E02","F02","G02","H02",
		"A03","B03","C03","D03","E03","F03","G03","H03",
		"A04","B04","C04","D04","E04","F04","G04","H04",
		"A05","B05","C05","D05","E05","F05","G05","H05",
		"A06","B06","C06","D06","E06","F06","G06","H06",
		"A07","B07","C07","D07","E07","F07","G07","H07",
		"A08","B08","C08","D08","E08","F08","G08","H08",
		"A09","B09","C09","D09","E09","F09","G09","H09"
		};
	
	public static final String[] RM96_AlphaCoord = {
		"A01","A02","A03","A04","A05","A06","A07","A08","A09","A10","A11","A12",
		"B01","B02","B03","B04","B05","B06","B07","B08","B09","B10","B11","B12",
		"C01","C02","C03","C04","C05","C06","C07","C08","C09","C10","C11","C12",
		"D01","D02","D03","D04","D05","D06","D07","D08","D09","D10","D11","D12",
		"E01","E02","E03","E04","E05","E06","E07","E08","E09","E10","E11","E12",
		"F01","F02","F03","F04","F05","F06","F07","F08","F09","F10","F11","F12",
		"G01","G02","G03","G04","G05","G06","G07","G08","G09","G10","G11","G12",
		"H01","H02","H03","H04","H05","H06","H07","H08","H09","H10","H11","H12"
		};
	
	public static final String[] RM96_AlphaCoord_Biochem = {
		"A01","A02","A03","A04","A05","A06","A07","A08","A09",
		"B01","B02","B03","B04","B05","B06","B07","B08","B09",
		"C01","C02","C03","C04","C05","C06","C07","C08","C09",
		"D01","D02","D03","D04","D05","D06","D07","D08","D09",
		"E01","E02","E03","E04","E05","E06","E07","E08","E09",
		"F01","F02","F03","F04","F05","F06","F07","F08","F09",
		"G01","G02","G03","G04","G05","G06","G07","G08","G09",
		"H01","H02","H03","H04","H05","H06","H07","H08","H09"
		};
	
	public static final String[] CM384_AlphaCoord = {
		"A01","B01","C01","D01","E01","F01","G01","H01","I01","J01","K01","L01","M01","N01","O01","P01",
		"A02","B02","C02","D02","E02","F02","G02","H02","I02","J02","K02","L02","M02","N02","O02","P02",
		"A03","B03","C03","D03","E03","F03","G03","H03","I03","J03","K03","L03","M03","N03","O03","P03",
		"A04","B04","C04","D04","E04","F04","G04","H04","I04","J04","K04","L04","M04","N04","O04","P04",
		"A05","B05","C05","D05","E05","F05","G05","H05","I05","J05","K05","L05","M05","N05","O05","P05",
		"A06","B06","C06","D06","E06","F06","G06","H06","I06","J06","K06","L06","M06","N06","O06","P06",
		"A07","B07","C07","D07","E07","F07","G07","H07","I07","J07","K07","L07","M07","N07","O07","P07",
		"A08","B08","C08","D08","E08","F08","G08","H08","I08","J08","K08","L08","M08","N08","O08","P08",
		"A09","B09","C09","D09","E09","F09","G09","H09","I09","J09","K09","L09","M09","N09","O09","P09",
		"A10","B10","C10","D10","E10","F10","G10","H10","I10","J10","K10","L10","M10","N10","O10","P10",
		"A11","B11","C11","D11","E11","F11","G11","H11","I11","J11","K11","L11","M11","N11","O11","P11",
		"A12","B12","C12","D12","E12","F12","G12","H12","I12","J12","K12","L12","M12","N12","O12","P12",
		"A13","B13","C13","D13","E13","F13","G13","H13","I13","J13","K13","L13","M13","N13","O13","P13",
		"A14","B14","C14","D14","E14","F14","G14","H14","I14","J14","K14","L14","M14","N14","O14","P14",
		"A15","B15","C15","D15","E15","F15","G15","H15","I15","J15","K15","L15","M15","N15","O15","P15",
		"A16","B16","C16","D16","E16","F16","G16","H16","I16","J16","K16","L16","M16","N16","O16","P16",
		"A17","B17","C17","D17","E17","F17","G17","H17","I17","J17","K17","L17","M17","N17","O17","P17",
		"A18","B18","C18","D18","E18","F18","G18","H18","I18","J18","K18","L18","M18","N18","O18","P18",
		"A19","B19","C19","D19","E19","F19","G19","H19","I19","J19","K19","L19","M19","N19","O19","P19",
		"A20","B20","C20","D20","E20","F20","G20","H20","I20","J20","K20","L20","M20","N20","O20","P20",
		"A21","B21","C21","D21","E21","F21","G21","H21","I21","J21","K21","L21","M21","N21","O21","P21",
		"A22","B22","C22","D22","E22","F22","G22","H22","I22","J22","K22","L22","M22","N22","O22","P22",
		"A23","B23","C23","D23","E23","F23","G23","H23","I23","J23","K23","L23","M23","N23","O23","P23",
		"A24","B24","C24","D24","E24","F24","G24","H24","I24","J24","K24","L24","M24","N24","O24","P24"
		};
	
	public static final String[] RM384_AlphaCoord = {
		"A01","A02","A03","A04","A05","A06","A07","A08","A09","A10","A11","A12","A13","A14","A15","A16","A17","A18","A19","A20","A21","A22","A23","A24",
		"B01","B02","B03","B04","B05","B06","B07","B08","B09","B10","B11","B12","B13","B14","B15","B16","B17","B18","B19","B20","B21","B22","B23","B24",
		"C01","C02","C03","C04","C05","C06","C07","C08","C09","C10","C11","C12","C13","C14","C15","C16","C17","C18","C19","C20","C21","C22","C23","C24",
		"D01","D02","D03","D04","D05","D06","D07","D08","D09","D10","D11","D12","D13","D14","D15","D16","D17","D18","D19","D20","D21","D22","D23","D24",
		"E01","E02","E03","E04","E05","E06","E07","E08","E09","E10","E11","E12","E13","E14","E15","E16","E17","E18","E19","E20","E21","E22","E23","E24",
		"F01","F02","F03","F04","F05","F06","F07","F08","F09","F10","F11","F12","F13","F14","F15","F16","F17","F18","F19","F20","F21","F22","F23","F24",
		"G01","G02","G03","G04","G05","G06","G07","G08","G09","G10","G11","G12","G13","G14","G15","G16","G17","G18","G19","G20","G21","G22","G23","G24",
		"H01","H02","H03","H04","H05","H06","H07","H08","H09","H10","H11","H12","H13","H14","H15","H16","H17","H18","H19","H20","H21","H22","H23","H24",
		"I01","I02","I03","I04","I05","I06","I07","I08","I09","I10","I11","I12","I13","I14","I15","I16","I17","I18","I19","I20","I21","I22","I23","I24",
		"J01","J02","J03","J04","J05","J06","J07","J08","J09","J10","J11","J12","J13","J14","J15","J16","J17","J18","J19","J20","J21","J22","J23","J24",
		"K01","K02","K03","K04","K05","K06","K07","K08","K09","K10","K11","K12","K13","K14","K15","K16","K17","K18","K19","K20","K21","K22","K23","K24",
		"L01","L02","L03","L04","L05","L06","L07","L08","L09","L10","L11","L12","L13","L14","L15","L16","L17","L18","L19","L20","L21","L22","L23","L24",
		"M01","M02","M03","M04","M05","M06","M07","M08","M09","M10","M11","M12","M13","M14","M15","M16","M17","M18","M19","M20","M21","M22","M23","M24",
		"N01","N02","N03","N04","N05","N06","N07","N08","N09","N10","N11","N12","N13","N14","N15","N16","N17","N18","N19","N20","N21","N22","N23","N24",
		"O01","O02","O03","O04","O05","O06","O07","O08","O09","O10","O11","O12","O13","O14","O15","O16","O17","O18","O19","O20","O21","O22","O23","O24",
		"P01","P02","P03","P04","P05","P06","P07","P08","P09","P10","P11","P12","P13","P14","P15","P16","P17","P18","P19","P20","P21","P22","P23","P24",
		
	};
	
	/**
	 * returns the alpha coord for a particular layout
	 * @param layout
	 * @param numericWell
	 * @return
	 * @throws Exception
	 */
	public static String getAlphaCoord(int layout, int numericWell)
		throws Exception
	{
		String rtn = null;
		if(layout == PlateLayout.CM_96WELL)
		{
			if(bUseBiochemLayout)
			{
				if(numericWell < 1 || numericWell > PlateLayout.CM96_AlphaCoord_Biochem.length + 1)
					throw new Exception("The numeric well must be between 1 and " + (PlateLayout.CM96_AlphaCoord_Biochem.length + 1));
				rtn = PlateLayout.CM96_AlphaCoord_Biochem[numericWell - 1];
			}
			else if(bUseIsolateLayout)
			{
				if(numericWell < 1 || numericWell > PlateLayout.CM96_AlphaCoord_Isolates.length + 1)
					throw new Exception("The numeric well must be between 1 and " + (PlateLayout.CM96_AlphaCoord_Isolates.length + 1));
				rtn = PlateLayout.CM96_AlphaCoord_Isolates[numericWell - 1];
			}
			else 
			{
				if(numericWell < 1 || numericWell > 96)
					throw new Exception("The numeric well must be between 1 and 96.");
				rtn = PlateLayout.CM96_AlphaCoord[numericWell - 1];
			}
		}
		else if(layout == PlateLayout.RM_96WELL)
		{
			if(bUseBiochemLayout)
			{
				if(numericWell < 1 || numericWell > PlateLayout.RM96_AlphaCoord_Biochem.length + 1)
					throw new Exception("The numeric well must be between 1 and " + (PlateLayout.RM96_AlphaCoord_Biochem.length + 1));
				rtn = PlateLayout.RM96_AlphaCoord_Biochem[numericWell - 1];
			}
			else
			{
				if(numericWell < 1 || numericWell > 96)
					throw new Exception("The numeric well must be between 1 and 96.");
				rtn = PlateLayout.RM96_AlphaCoord[numericWell - 1];
			}
			
		}
		else if(layout == PlateLayout.CM_384WELL)
		{
			if(numericWell < 1 || numericWell > 384)
				throw new Exception("The numeric well must be between 1 and 384.");
			rtn = PlateLayout.CM384_AlphaCoord[numericWell - 1];
		}
		else if(layout == PlateLayout.RM_384WELL)
		{
			if(numericWell < 1 || numericWell > 384)
				throw new Exception("The numeric well must be between 1 and 384.");
			rtn = PlateLayout.RM384_AlphaCoord[numericWell - 1];
		}
		else
			throw new Exception("Unknown plate layout.");
		return rtn;
	}
	
	/**
	 * returns the numeric coordinate that corresponds to the alpha coordinate
	 * @param layout
	 * @param alphaCoord
	 * @return
	 * @throws Exception
	 */
	public static int getNumericCoord(int layout, String alphaCoord)
		throws Exception
	{
		int rtn = -1;
		boolean bFoundCoord = false;
		if(layout == PlateLayout.CM_96WELL)
		{
			for(int i = 0; i < 96; i++ )
			{
				String coord = null;
				if(bUseBiochemLayout)
					coord = PlateLayout.CM96_AlphaCoord_Biochem[i];
				else if (bUseIsolateLayout)
					coord = PlateLayout.CM96_AlphaCoord_Isolates[i];
				else
					coord = PlateLayout.CM96_AlphaCoord[i];
				if(coord.equalsIgnoreCase(alphaCoord))
				{
					rtn = i + 1;
					bFoundCoord = true;
					break;
				}
			}
		}
		else if(layout == PlateLayout.RM_96WELL)
		{
			for(int i = 0; i < 96; i++ )
			{
				String coord = null;
				if(bUseBiochemLayout)
					coord = PlateLayout.RM96_AlphaCoord_Biochem[i];
				else
					coord = PlateLayout.RM96_AlphaCoord[i];
				if(coord.equalsIgnoreCase(alphaCoord))
				{
					rtn = i + 1;
					bFoundCoord = true;
					break;
				}		
			}
		}
		else if(layout == PlateLayout.CM_384WELL)
		{
			for(int i = 0; i < 384; i++ )
			{
				String coord = PlateLayout.CM384_AlphaCoord[i];
				if(coord.equalsIgnoreCase(alphaCoord))
				{
					rtn = i + 1;
					bFoundCoord = true;
					break;
				}
			}
		}
		else if(layout == PlateLayout.RM_384WELL)
		{
			for(int i = 0; i < 384; i++ )
			{
				String coord = PlateLayout.RM384_AlphaCoord[i];
				if(coord.equalsIgnoreCase(alphaCoord))
				{
					rtn = i + 1;
					bFoundCoord = true;
					break;
				}
			}
		}
		else
			throw new Exception("Unknown plate layout.");
		if(!bFoundCoord)
			throw new Exception("Please enter a valid alpha coord and try again.");
		return rtn;
	}
	
	public static int getLayoutSize(int layout)
		throws Exception
	{
		int rtn = -1;
		
		if(layout == PlateLayout.CM_96WELL)
		{
			if(bUseBiochemLayout)
				rtn = PlateLayout.CM96_AlphaCoord_Biochem.length;
			else
				rtn = PlateLayout.CM96_AlphaCoord.length;
		}
		else if(layout == PlateLayout.RM_96WELL)
		{
			if(bUseBiochemLayout)
				rtn = PlateLayout.RM96_AlphaCoord_Biochem.length;
			else
				rtn = PlateLayout.RM96_AlphaCoord.length;
		}
		else if(layout == PlateLayout.CM_384WELL)
			rtn = PlateLayout.CM384_AlphaCoord.length;
		else if(layout == PlateLayout.RM_384WELL)
			rtn = PlateLayout.RM384_AlphaCoord.length;
		else
			throw new Exception("Unable to determine size of layout because layout is unknown.");
		return rtn;
	}

	public static int getCM_96WELL() {
		return CM_96WELL;
	}

	public static int getRM_96WELL() {
		return RM_96WELL;
	}

	public static int getCM_384WELL() {
		return CM_384WELL;
	}

	public static int getRM_384WELL() {
		return RM_384WELL;
	}

	public static boolean isBUseBiochemLayout() {
		return bUseBiochemLayout;
	}

	public static void setBUseBiochemLayout(boolean useBiochemLayout) {
		bUseBiochemLayout = useBiochemLayout;
	}
	
	public static void setBUseIsolateLayout(boolean useIsolateLayout) {
		bUseIsolateLayout = useIsolateLayout;
	}
	
}
